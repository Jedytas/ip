# Первая строка содержит число команд в футбольном турнире N. 
# Далее идут N строк, описывающих команды, каждая строка состоит из названия команды 
# и числа набранных очков. Далее идут записи результатов матчей. 
# Одна строка соответствует одному матчу и содержит название двух команд, игравших в этом матче, и итог матча (победа, ничья или поражение).
# Выведите список команд, упорядоченный по убыванию числа набранных ими очков, а при равенстве числа очков: в лексикографическом порядке.
# После названия команды выведите число набранных ею очков.



# Чтение количества команд
N = int(input("Введите количество команд в турнире: "))
teams = {}

# Чтение начальных данных команд и их очков
print("\nВведите название команды и её начальные очки (через пробел):")
for _ in range(N):
    line = input(f"Команда {_ + 1}: ").split()
    team_name = " ".join(line[:-1])  # Название команды может состоять из нескольких слов
    points = int(line[-1])           # Последний элемент — это очки
    teams[team_name] = points

# Чтение и обработка матчей
M = int(input("\nВведите количество матчей: "))
print("\nВведите результаты матчей в формате 'Команда1 Команда2 результат' (победа, ничья, поражение):")
for i in range(M):
    match = input(f"Результат матча {i + 1}: ").split()
    team1 = match[0]   # Название первой команды
    team2 = match[1]   # Название второй команды
    result = match[2]  # Результат (победа, ничья или поражение)

    if result == "победа":
        teams[team1] += 3  # Первая команда победила
    elif result == "ничья":
        teams[team1] += 1  # Обе команды получают по 1 очку
        teams[team2] += 1
    elif result == "поражение":
        teams[team2] += 3  # Вторая команда победила

# Сортировка команд по очкам (по убыванию), а затем в лексикографическом порядке
sorted_teams = sorted(teams.items(), key=lambda x: (-x[1], x[0]))

# Вывод результатов
print("\nРезультаты турнира:")
for team, points in sorted_teams:
    print(f"{team}: {points} очков")
